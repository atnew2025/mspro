<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase è®¤è¯æµ‹è¯•</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a2e;
            color: #fff;
        }
        .info-box {
            background: #16213e;
            border: 1px solid #0f3460;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .success { border-left: 4px solid #4caf50; }
        .error { border-left: 4px solid #f44336; }
        .warning { border-left: 4px solid #ff9800; }
        button {
            background: #6366f1;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #4f46e5;
        }
        pre {
            background: #0f3460;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        h2 { color: #6366f1; }
    </style>
</head>
<body>
    <h1>ğŸ” Firebase è®¤è¯è¯Šæ–­å·¥å…·</h1>
    
    <div class="info-box warning">
        <h2>å½“å‰ç¯å¢ƒä¿¡æ¯</h2>
        <p><strong>åè®®ï¼š</strong><span id="protocol"></span></p>
        <p><strong>ä¸»æœºï¼š</strong><span id="hostname"></span></p>
        <p><strong>ç«¯å£ï¼š</strong><span id="port"></span></p>
        <p><strong>å®Œæ•´ URLï¼š</strong><span id="fullUrl"></span></p>
    </div>

    <div class="info-box">
        <h2>Firebase é…ç½®çŠ¶æ€</h2>
        <p id="firebaseStatus">æ£€æŸ¥ä¸­...</p>
    </div>

    <div class="info-box">
        <h2>æµ‹è¯•ç™»å½•æ–¹å¼</h2>
        <button onclick="testEmailAuth()">æµ‹è¯•é‚®ç®±ç™»å½•</button>
        <button onclick="testGoogleAuth()">æµ‹è¯• Google ç™»å½•</button>
        <button onclick="testGithubAuth()">æµ‹è¯• GitHub ç™»å½•</button>
        <button onclick="checkAuthDomain()">æ£€æŸ¥æˆæƒåŸŸå</button>
    </div>

    <div class="info-box" id="resultBox" style="display: none;">
        <h2>æµ‹è¯•ç»“æœ</h2>
        <pre id="result"></pre>
    </div>

    <div class="info-box success">
        <h2>ğŸ“‹ è§£å†³æ–¹æ¡ˆ</h2>
        <ol>
            <li>è®¿é—® <a href="https://console.firebase.google.com/project/akinktogo/authentication/settings" target="_blank" style="color: #6366f1;">Firebase æ§åˆ¶å°</a></li>
            <li>åœ¨ "Authorized domains" éƒ¨åˆ†ï¼Œç¡®ä¿å·²æ·»åŠ ï¼š
                <ul>
                    <li><code>localhost</code></li>
                    <li><code>127.0.0.1</code></li>
                </ul>
            </li>
            <li>å¦‚æœæ²¡æœ‰ï¼Œç‚¹å‡» "Add domain" æ·»åŠ è¿™äº›åŸŸå</li>
            <li>ä¿å­˜ååˆ·æ–°é¡µé¢é‡è¯•</li>
        </ol>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

    <script>
        // æ˜¾ç¤ºç¯å¢ƒä¿¡æ¯
        document.getElementById('protocol').textContent = window.location.protocol;
        document.getElementById('hostname').textContent = window.location.hostname;
        document.getElementById('port').textContent = window.location.port || '(é»˜è®¤)';
        document.getElementById('fullUrl').textContent = window.location.href;

        // Firebase é…ç½®
        const firebaseConfig = {
            apiKey: "AIzaSyCOS1e_2xFyE8YaoXtTOHaTTHsMja2uqgs",
            authDomain: "akinktogo.firebaseapp.com",
            projectId: "akinktogo",
            storageBucket: "akinktogo.firebasestorage.app",
            messagingSenderId: "333801806014",
            appId: "1:333801806014:web:59c6f92be7f8f06189a6ef",
            measurementId: "G-4F4GST4D0P"
        };

        // åˆå§‹åŒ– Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            const auth = firebase.auth();
            document.getElementById('firebaseStatus').innerHTML = 'âœ… Firebase åˆå§‹åŒ–æˆåŠŸ<br>é¡¹ç›® ID: ' + firebaseConfig.projectId;
        } catch (error) {
            document.getElementById('firebaseStatus').innerHTML = 'âŒ Firebase åˆå§‹åŒ–å¤±è´¥: ' + error.message;
        }

        function showResult(message, isError = false) {
            const resultBox = document.getElementById('resultBox');
            const result = document.getElementById('result');
            resultBox.style.display = 'block';
            resultBox.className = 'info-box ' + (isError ? 'error' : 'success');
            result.textContent = message;
        }

        function testEmailAuth() {
            showResult('é‚®ç®±ç™»å½•æµ‹è¯•ï¼š\n\n' +
                '1. é‚®ç®±ç™»å½•ä¸éœ€è¦æˆæƒåŸŸå\n' +
                '2. ç¡®ä¿åœ¨ Firebase æ§åˆ¶å°å¯ç”¨äº† "Email/Password" ç™»å½•æ–¹å¼\n' +
                '3. è®¿é—®ï¼šhttps://console.firebase.google.com/project/akinktogo/authentication/providers\n' +
                '4. å¯ç”¨ "Email/Password" é€‰é¡¹');
        }

        async function testGoogleAuth() {
            try {
                const provider = new firebase.auth.GoogleAuthProvider();
                showResult('æ­£åœ¨æµ‹è¯• Google ç™»å½•...\nè¯·åœ¨å¼¹å‡ºçª—å£ä¸­é€‰æ‹©è´¦å·');
                
                const result = await firebase.auth().signInWithPopup(provider);
                showResult('âœ… Google ç™»å½•æˆåŠŸï¼\n\nç”¨æˆ·ä¿¡æ¯ï¼š\n' + JSON.stringify({
                    email: result.user.email,
                    displayName: result.user.displayName,
                    uid: result.user.uid
                }, null, 2));
            } catch (error) {
                showResult('âŒ Google ç™»å½•å¤±è´¥\n\n' +
                    'é”™è¯¯ä»£ç : ' + error.code + '\n' +
                    'é”™è¯¯ä¿¡æ¯: ' + error.message + '\n\n' +
                    'è§£å†³æ–¹æ¡ˆï¼š\n' +
                    '1. è®¿é—® Firebase æ§åˆ¶å°\n' +
                    '2. Authentication â†’ Settings â†’ Authorized domains\n' +
                    '3. æ·»åŠ  "localhost" åˆ°æˆæƒåŸŸååˆ—è¡¨\n' +
                    '4. ç¡®ä¿å¯ç”¨äº† Google ç™»å½•æ–¹å¼', true);
            }
        }

        async function testGithubAuth() {
            try {
                const provider = new firebase.auth.GithubAuthProvider();
                showResult('æ­£åœ¨æµ‹è¯• GitHub ç™»å½•...\nè¯·åœ¨å¼¹å‡ºçª—å£ä¸­æˆæƒ');
                
                const result = await firebase.auth().signInWithPopup(provider);
                showResult('âœ… GitHub ç™»å½•æˆåŠŸï¼\n\nç”¨æˆ·ä¿¡æ¯ï¼š\n' + JSON.stringify({
                    email: result.user.email,
                    displayName: result.user.displayName,
                    uid: result.user.uid,
                    photoURL: result.user.photoURL
                }, null, 2));
            } catch (error) {
                showResult('âŒ GitHub ç™»å½•å¤±è´¥\n\n' +
                    'é”™è¯¯ä»£ç : ' + error.code + '\n' +
                    'é”™è¯¯ä¿¡æ¯: ' + error.message + '\n\n' +
                    'å¯èƒ½çš„åŸå› ï¼š\n' +
                    '1. GitHub OAuth App æœªé…ç½®\n' +
                    '2. æˆæƒåŸŸåæœªæ·»åŠ \n' +
                    '3. GitHub ç™»å½•æ–¹å¼æœªå¯ç”¨\n\n' +
                    'è§£å†³æ–¹æ¡ˆï¼š\n' +
                    '1. è®¿é—® https://github.com/settings/developers\n' +
                    '2. åˆ›å»º OAuth App\n' +
                    '3. åœ¨ Firebase æ§åˆ¶å°é…ç½® GitHub ç™»å½•\n' +
                    '4. å¡«å…¥ Client ID å’Œ Client Secret', true);
            }
        }

        function checkAuthDomain() {
            const currentDomain = window.location.hostname;
            const authDomain = firebaseConfig.authDomain;
            
            showResult('åŸŸåæ£€æŸ¥ç»“æœï¼š\n\n' +
                'å½“å‰åŸŸå: ' + currentDomain + '\n' +
                'Firebase Auth åŸŸå: ' + authDomain + '\n\n' +
                'éœ€è¦åœ¨ Firebase æ§åˆ¶å°æ·»åŠ çš„æˆæƒåŸŸåï¼š\n' +
                '- localhost\n' +
                '- 127.0.0.1\n' +
                '- ' + currentDomain + '\n\n' +
                'é…ç½®åœ°å€ï¼š\n' +
                'https://console.firebase.google.com/project/akinktogo/authentication/settings');
        }

        // ç›‘å¬è®¤è¯çŠ¶æ€
        firebase.auth().onAuthStateChanged((user) => {
            if (user) {
                console.log('ç”¨æˆ·å·²ç™»å½•:', user);
            } else {
                console.log('ç”¨æˆ·æœªç™»å½•');
            }
        });
    </script>
</body>
</html>
